# Kapsis Configuration - Claude Code Agent
# Use with: ./scripts/launch-agent.sh 1 ~/project --config configs/claude.yaml

agent:
  # Claude Code with spec file input
  command: "claude --dangerously-skip-permissions -p \"$(cat /task-spec.md)\""
  workdir: /workspace

filesystem:
  include:
    - ~/.claude
    - ~/.claude.json
    - ~/.gitconfig
    - ~/.ssh
    - ~/.zshrc

environment:
  # Retrieve API key from system keychain (macOS Keychain / Linux secret-tool)
  keychain:
    ANTHROPIC_API_KEY:
      service: "Claude Code-credentials"
  # Alternative: Use passthrough if you prefer to export ANTHROPIC_API_KEY manually
  # passthrough:
  #   - ANTHROPIC_API_KEY
  set:
    MAVEN_OPTS: "-Xmx4g -XX:+UseG1GC"

resources:
  memory: 8g
  cpus: 4

maven:
  mirror_url: "https://artifactory.example.org/artifactory/releases"
  block_remote_snapshots: true
  block_deploy: true

git:
  auto_push:
    enabled: true
    remote: origin
    commit_message: |
      feat: {task}

      Generated by Claude Code via Kapsis
      Branch: {branch}
