# Kapsis Configuration - Codex CLI Agent
# Use with: ./scripts/launch-agent.sh ~/project --config configs/codex.yaml

agent:
  # Codex CLI with full auto approval
  command: "codex --approval-mode full-auto \"$(cat /task-spec.md)\""
  workdir: /workspace

filesystem:
  include:
    - ~/.codex
    - ~/.gitconfig
    - ~/.ssh
    - ~/.zshrc

environment:
  passthrough:
    - OPENAI_API_KEY
  set:
    MAVEN_OPTS: "-Xmx4g -XX:+UseG1GC"

resources:
  memory: 8g
  cpus: 4

maven:
  mirror_url: "https://artifactory.example.org/artifactory/releases"
  block_remote_snapshots: true
  block_deploy: true

git:
  auto_push:
    enabled: true
    remote: origin
    commit_message: |
      feat: {task}

      Generated by Codex CLI via Kapsis
      Branch: {branch}

  # Co-authors added to every commit (Git trailer format)
  co_authors:
    - "Aviad Shiber <aviadshiber@gmail.com>"

  # Files to exclude from commits (prevents accidental commits)
  commit_exclude:
    - ".gitignore"
    - "**/.gitignore"

  # Fork-first workflow for contributing to external repos
  fork_workflow:
    enabled: false
    fallback: fork
